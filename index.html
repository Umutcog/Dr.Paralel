<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TERMINAL: NEBULA_STRATEGY_V9.3</title>
    <link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">
    <style>
        body { margin: 0; padding: 0; background: #000; color: #0f0; font-family: 'VT323', monospace; overflow: hidden; }
        .scanlines { position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; pointer-events: none; z-index: 999; background: linear-gradient(rgba(18,16,16,0) 50%, rgba(0,0,0,0.1) 50%), linear-gradient(90deg, rgba(255,0,0,0.03), rgba(0,255,0,0.01), rgba(0,0,255,0.03)); background-size: 100% 3px, 3px 100%; }
        #terminal { width: 95vw; height: 95vh; margin: 2.5vh auto; border: 2px solid #0f0; background: #050505; display: flex; flex-direction: column; box-shadow: 0 0 25px #0f0; position: relative; }
        .header { background: #0f0; color: #000; padding: 8px 20px; font-weight: bold; font-size: 24px; display: flex; justify-content: space-between; }
        .screen { flex: 1; overflow-y: auto; padding: 25px; position: relative; }
        .mission-log { font-size: 26px; color: #0f0; margin-bottom: 20px; border-left: 6px solid #d32f2f; padding-left: 15px; }
        .clue-box { color: #00f3ff; font-size: 19px; border: 1px dashed #00f3ff; padding: 12px; background: rgba(0,243,255,0.05); margin-bottom: 10px; }
        .meb-clue { color: #ff00ff; font-weight: bold; font-size: 17px; margin-top: 5px; }
        
        /* ETKİLEŞİM */
        .choice-container { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 20px; }
        button { background: #000; border: 2px solid #0f0; color: #0f0; padding: 15px; font-family: 'VT323'; font-size: 22px; cursor: pointer; transition: 0.1s; }
        button:hover { background: #0f0; color: #000; box-shadow: 0 0 15px #0f0; }
        .skip-btn { border-color: #d32f2f; color: #d32f2f; font-size: 18px; margin-top: 30px; width: 100%; }
        .skip-btn:hover { background: #d32f2f; color: #fff; }
        
        input { background: #000; border: 2px solid #0f0; color: #0f0; font-family: 'VT323'; font-size: 28px; padding: 10px; width: 90%; outline: none; margin-top: 15px; }
        
        /* EŞLEŞTİRME */
        .drop-area { display: flex; gap: 15px; margin-top: 20px; justify-content: space-around; }
        .zone { border: 2px dashed #0f0; padding: 15px; min-height: 80px; width: 40%; text-align: center; font-size: 18px; }
        .zone.active { background: #003300; }
        .drag-pool { border: 1px solid #555; padding: 15px; margin-top: 15px; display: flex; flex-wrap: wrap; gap: 10px; justify-content: center; }
        .drag-item { background: #111; border: 1px solid #0f0; padding: 8px 15px; cursor: pointer; }
        .drag-item.selected { background: #0f0; color: #000; }

        .final-code { border: 5px double #00f3ff; color: #00f3ff; padding: 30px; font-size: 45px; text-align: center; cursor: pointer; margin-top: 20px; }
    </style>
</head>
<body>
<div class="scanlines"></div>

<div id="terminal">
    <div class="header">
        <span>STATION: ENKA_GLOBAL_CORE</span>
        <span id="progress">GÖREV: 1 / 50</span>
    </div>
    <div class="screen" id="main-screen">
        <div id="mission-text" class="mission-log"></div>
        <div id="clue-box" class="clue-box"></div>
        <div id="interactive-content"></div>
        <button id="skip-button" class="skip-btn" onclick="skipMission()">[!] GÖREVİ ATLA (-50 PUAN)</button>
    </div>
</div>

<script>
    let currentStep = 0;
    let score = 100;
    let selectedItem = null;

    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    function playSfx(f, d, t='sine') {
        if (audioCtx.state === 'suspended') audioCtx.resume();
        const o = audioCtx.createOscillator(); const g = audioCtx.createGain();
        o.type = t; o.frequency.value = f; g.gain.value = 0.05;
        o.connect(g); g.connect(audioCtx.destination);
        o.start(); o.stop(audioCtx.currentTime + d);
    }

    const steps = [
        // 1. SORU - SEÇENEKLİ
        { 
            text: "SİSTEM ANALİZİ: Dr. Paralel 'Hava yarın yağmurlu' dediğinde hangisini kastetmiş olur?", 
            type: "choice", 
            ans: 1, 
            options: ["İKLİM ÖZELLİĞİ", "HAVA DURUMU"], 
            meb: "MEB Kitabı Sayfa 1: 3.1.2. İklim Sistemi giriş cümlesine bak." 
        },
        // 2. SORU - SEÇENEKLİ
        { 
            text: "İklim değişkenleri (nem, rüzgar, yağış) sistemde nasıl bir rol oynar?", 
            type: "choice", 
            ans: 0, 
            options: ["ANAHTAR ROL OYNARLAR", "ÖNEMSİZDİRLER"], 
            meb: "MEB Kitabı Sayfa 1: İkinci paragrafın son cümlesi." 
        },
        // 3. SORU - EŞLEŞTİRME (Kutu)
        { 
            text: "VERİ TASNİFİ: Aşağıdaki kavramları doğru kürelere yerleştir.", 
            type: "match", 
            items: [
                {id: "i1", text: "Okyanuslar", target: "hidro"},
                {id: "i2", text: "Buzullar", target: "kriyo"}
            ],
            zones: [
                {id: "hidro", label: "HİDROSFER"},
                {id: "kriyo", label: "KRİYOSFER"}
            ],
            meb: "MEB Sayfa 1: İklim Sisteminin Bileşenleri şemasını incele."
        },
        // 4. SORU - KISA CEVAP
        { 
            text: "Buzulların güneş ışığını yansıtma kapasitesini tanımlayan teknik terim?", 
            type: "input", 
            ans: "ALBEDO", 
            meb: "MEB Sayfa 2: Metin içindeki terimi bul." 
        },
        // 5. SORU - SEÇENEKLİ
        { 
            text: "Okyanustaki fitoplanktonlar iklimi nasıl dengeler?", 
            type: "choice", 
            ans: 1, 
            options: ["SULARI ISITARAK", "CO2 MİKTARINI ETKİLEYEREK"], 
            meb: "MEB Sayfa 2: İklim ve okyanus etkileşimi paragrafı." 
        },
        // 6. SORU - EŞLEŞTİRME (Kutu)
        { 
            text: "ATMOSFER ANALİZİ: Katmanları özelliklerine göre ayır.", 
            type: "match", 
            items: [
                {id: "a1", text: "Hava Olayları", target: "tropo"},
                {id: "a2", text: "Ozon Tabakası", target: "strato"}
            ],
            zones: [
                {id: "tropo", label: "TROPOSFER"},
                {id: "strato", label: "STRATOSFER"}
            ],
            meb: "MEB Sayfa 3-4: Atmosfer katmanları başlıklarına bak."
        },
        // ... (Bu yapı 50 soruya kadar MEB kitabına ve senin listene göre devam eder)
        { 
            text: "BAHÇE GÖREVİ: Atatürk büstünde yazan o uzun cümleyi terminale hatasız gir.", 
            type: "input", 
            ans: "KİŞİNİN BİRİNCİ HAKKI DOĞAL YETENEKLERİNİ SERBESTÇE GELİŞTİREBİLMESİDİR", 
            meb: "Okul bahçesindeki fiziksel büstten veriyi topla!" 
        }
    ];

    function loadStep(idx) {
        if (idx >= steps.length) { finishGame(); return; }
        currentStep = idx;
        const s = steps[idx];
        document.getElementById('progress').innerText = `GÖREV: ${idx + 1} / 50`;
        document.getElementById('mission-text').innerText = `> ${s.text}`;
        document.getElementById('clue-box').innerHTML = `[!] MEB REHBERİ: ${s.meb}`;
        
        const content = document.getElementById('interactive-content');
        content.innerHTML = '';
        selectedItem = null;

        if (s.type === "choice") {
            const container = document.createElement('div');
            container.className = "choice-container";
            s.options.forEach((opt, oIdx) => {
                const btn = document.createElement('button');
                btn.innerText = opt;
                btn.onclick = () => checkChoice(oIdx, s.ans);
                container.appendChild(btn);
            });
            content.appendChild(container);
        } else if (s.type === "input") {
            const input = document.createElement('input');
            input.id = "user-input";
            input.placeholder = "VERİ GİRİŞİ...";
            input.autocomplete = "off";
            content.appendChild(input);
            input.focus();
            input.onkeypress = (e) => { if(e.key === "Enter") checkInput(input.value, s.ans); };
        } else if (s.type === "match") {
            const zonesDiv = document.createElement('div');
            zonesDiv.className = "drop-area";
            s.zones.forEach(z => {
                const zDiv = document.createElement('div');
                zDiv.className = "zone";
                zDiv.id = z.id;
                zDiv.innerHTML = `<h4>${z.label}</h4>`;
                zDiv.onclick = () => placeItem(zDiv, s.items.length);
                zonesDiv.appendChild(zDiv);
            });
            const pool = document.createElement('div');
            pool.className = "drag-pool";
            pool.id = "pool";
            s.items.forEach(i => {
                const iDiv = document.createElement('div');
                iDiv.className = "drag-item";
                iDiv.innerText = i.text;
                iDiv.dataset.target = i.target;
                iDiv.onclick = (e) => {
                    e.stopPropagation();
                    document.querySelectorAll('.drag-item').forEach(d => d.classList.remove('selected'));
                    iDiv.classList.add('selected');
                    selectedItem = iDiv;
                };
                pool.appendChild(iDiv);
            });
            content.appendChild(zonesDiv);
            content.appendChild(pool);
        }
    }

    function checkChoice(idx, correct) {
        if(idx === correct) { playSfx(800, 0.1); loadStep(currentStep + 1); }
        else { playSfx(100, 0.2, 'sawtooth'); score -= 2; }
    }

    function checkInput(val, correct) {
        const v = val.toUpperCase().trim().replace(/İ/g,"I").replace(/Ş/g,"S").replace(/Ğ/g,"G").replace(/Ü/g,"U").replace(/Ö/g,"O").replace(/Ç/g,"C");
        const c = correct.toUpperCase().trim().replace(/İ/g,"I").replace(/Ş/g,"S").replace(/Ğ/g,"G").replace(/Ü/g,"U").replace(/Ö/g,"O").replace(/Ç/g,"C");
        if(v === c) { playSfx(800, 0.1); loadStep(currentStep + 1); }
        else { playSfx(100, 0.2, 'sawtooth'); score -= 2; }
    }

    function placeItem(zone, totalItems) {
        if(!selectedItem) return;
        zone.appendChild(selectedItem);
        selectedItem.classList.remove('selected');
        selectedItem = null;
        
        const placed = document.querySelectorAll('.zone .drag-item');
        if(placed.length === totalItems) {
            let allCorrect = true;
            placed.forEach(item => {
                if(item.dataset.target !== item.parentElement.id) allCorrect = false;
            });
            if(allCorrect) { playSfx(800, 0.1); setTimeout(() => loadStep(currentStep + 1), 500); }
            else { 
                playSfx(100, 0.2, 'sawtooth'); 
                score -= 5; alert("VERİ TASNİFİ HATALI! SIFIRLANIYOR.");
                loadStep(currentStep);
            }
        }
    }

    function skipMission() {
        if(confirm("DİKKAT: Görevi atlamak 50 puana mal olur. Devam edilsin mi?")) {
            score -= 50;
            loadStep(currentStep + 1);
        }
    }

    function finishGame() {
        const code = `NEBULA-${score}-${Math.floor(Math.random()*999)}`;
        document.getElementById('main-screen').innerHTML = `
            <h1 style="color:#00f3ff">OPERASYON TAMAMLANDI</h1>
            <div class="final-code" onclick="copyCode('${code}')">${code}</div>
            <button class="btn" onclick="window.open('${googleFormLink}')" style="width:100%">RAPORU GÖNDER >></button>
        `;
        document.getElementById('skip-button').style.display = 'none';
    }

    function copyCode(c) {
        navigator.clipboard.writeText(c);
        alert("Kod kopyalandı!");
    }

    loadStep(0);
</script>
</body>
</html>
