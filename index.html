<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GEO-HACK V5.0: FULL OPERASYON</title>
    <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap" rel="stylesheet">
    <style>
        /* CSS: Hacker Tema */
        body {
            background-color: #111;
            color: #0f0;
            font-family: 'Share Tech Mono', monospace;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 5px;
            user-select: none;
        }

        #game-terminal {
            width: 100%;
            max-width: 700px;
            border: 3px solid #333;
            background-color: #000;
            position: relative;
            display: flex;
            flex-direction: column;
            height: 95vh;
            box-shadow: 0 0 30px rgba(0, 255, 0, 0.1);
        }

        .top-bar {
            background: #222;
            border-bottom: 2px solid #0f0;
            padding: 8px 15px;
            display: flex;
            justify-content: space-between;
            font-size: 14px;
        }

        .main-screen {
            flex-grow: 1;
            overflow-y: auto;
            padding: 15px;
            background: repeating-linear-gradient(0deg, rgba(0, 255, 0, 0.03) 0px, rgba(0, 255, 0, 0.03) 1px, transparent 1px, transparent 2px);
        }

        .img-frame { border: 1px solid #444; margin-bottom: 10px; background: #000; height: 160px; display: flex; align-items: center; justify-content: center; overflow: hidden; }
        #scene-image { width: 100%; height: 100%; object-fit: cover; filter: grayscale(80%) sepia(20%); }

        .log-text { 
            font-size: 15px; line-height: 1.5; margin-bottom: 15px; color: #eee; 
            border-left: 3px solid #d32f2f; padding-left: 10px; min-height: 50px;
        }

        /* TABLO */
        .table-wrapper { overflow-x: auto; margin: 10px 0; border: 1px solid #333; }
        .data-table { width: 100%; border-collapse: collapse; font-size: 12px; color: #ccc; text-align: center; min-width: 320px; }
        .data-table th { background: #222; color: #0f0; padding: 5px; border: 1px solid #444; }
        .data-table td { border: 1px solid #444; padding: 5px; cursor: crosshair; }
        .data-table tr:hover { background: #111; }
        .data-table td:hover { background: #004400; color: #fff; }

        /* INPUT VE BUTONLAR */
        .input-group { display: flex; gap: 10px; margin-top: 10px; }
        input { flex: 1; background: #111; border: 1px solid #0f0; color: #0f0; padding: 10px; font-family: inherit; font-size: 16px; text-transform: uppercase; }
        
        .control-panel { padding: 10px; background: #1a1a1a; display: grid; grid-template-columns: 1fr; gap: 8px; }
        button {
            background: #000; border: 1px solid #0f0; color: #0f0;
            padding: 12px; font-family: inherit; font-size: 15px; cursor: pointer;
            text-transform: uppercase; font-weight: bold; transition: 0.2s;
        }
        button:hover { background: #0f0; color: #000; }
        .btn-red { border-color: #d32f2f; color: #d32f2f; }

        /* SÃœRÃœKLE BIRAK */
        .pool { display: flex; flex-wrap: wrap; gap: 5px; justify-content: center; padding: 10px; border: 1px dashed #555; margin-bottom: 10px; }
        .item { background: #003300; border: 1px solid #0f0; padding: 5px 8px; cursor: pointer; font-size: 12px; }
        .item.selected { background: #0f0; color: #000; }
        .zones { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .zone { border: 2px solid #444; padding: 10px; min-height: 80px; text-align: center; font-size: 12px; }
        .zone.active { border-color: #0f0; background: #0b220b; }

        /* ANÄ°MASYONLAR */
        #plane-animation {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.95); z-index: 100; display: none;
            justify-content: center; align-items: center; flex-direction: column;
        }
        .plane-icon { font-size: 60px; animation: fly 1.5s linear infinite; }
        @keyframes fly { 0% { transform: translate(-100px, 20px) rotate(10deg); } 50% { transform: translate(0, -20px) rotate(-10deg); } 100% { transform: translate(100px, 20px) rotate(10deg); } }
        
        .start-btn { animation: pulse 1.5s infinite; border-color: #d32f2f; color: #d32f2f; }
        @keyframes pulse { 0% { box-shadow: 0 0 0 0 rgba(211, 47, 47, 0.4); } 70% { box-shadow: 0 0 0 10px transparent; } 100% { box-shadow: 0 0 0 0 transparent; } }

        /* Reklam Engelleyici */
        iframe, [class*="tiiny"], .tiiny-host-badge { display: none !important; }
    </style>
</head>
<body>

    <div id="game-terminal">
        <div class="top-bar">
            <span>DURUM: <span id="status-text" style="color:#d32f2f">BEKLEMEDE</span></span>
            <span>GÃ–REV: 10 AÅAMA</span>
        </div>

        <div class="main-screen" id="main-screen">
            <div class="img-frame">
                <img id="scene-image" src="https://images.unsplash.com/photo-1451187580459-43490279c0fa?w=800" alt="Cover">
            </div>
            <div id="game-text" class="log-text">
                GÃœVENLÄ° HAT...<br>
                AJAN, Ä°KLÄ°M KAOSUNU DURDURMAK Ä°Ã‡Ä°N 10 GÃ–REVÄ° TAMAMLAMALISIN.<br>
                <br>HAZIRSAN SÄ°STEMÄ° BAÅLAT.
            </div>
            
            <div id="dynamic-content"></div> 
            <div id="clue-box" style="margin-top:10px; font-size:13px; color:#888; font-style:italic;"></div>
        </div>

        <div class="control-panel" id="controls">
            <button onclick="startGame()" class="start-btn">ğŸ”´ SÄ°STEMÄ° BAÅLAT</button>
        </div>

        <div id="plane-animation">
            <div class="plane-icon">âœˆï¸</div>
            <div style="color:#0f0; margin-top:20px;">HEDEF BÃ–LGEYE GÄ°DÄ°LÄ°YOR...</div>
        </div>
    </div>

    <script>
        const googleFormLink = "https://docs.google.com/forms/d/e/1FAIpQLSetNN9DLHIN1mmEnwXKEljiq9I5lePMQ11LIjSjmBzvjc-qjA/viewform?usp=sharing&ouid=116024969586397151226"; 

        let score = 100;
        let selectedItem = null;

        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        function playSound(type) {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            const osc = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            osc.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            
            if(type==='fly'){ 
                osc.frequency.setValueAtTime(150, audioCtx.currentTime); 
                osc.frequency.linearRampToValueAtTime(50, audioCtx.currentTime+1); 
                gainNode.gain.setValueAtTime(0.1, audioCtx.currentTime); 
                osc.start(); osc.stop(audioCtx.currentTime+1); 
            }
            else if(type==='success'){ 
                osc.type='square'; osc.frequency.setValueAtTime(600, audioCtx.currentTime); 
                osc.frequency.linearRampToValueAtTime(1200, audioCtx.currentTime+0.1);
                gainNode.gain.setValueAtTime(0.05, audioCtx.currentTime); 
                osc.start(); osc.stop(audioCtx.currentTime+0.15); 
            }
            else { 
                osc.type='sawtooth'; osc.frequency.setValueAtTime(100, audioCtx.currentTime); 
                gainNode.gain.setValueAtTime(0.1, audioCtx.currentTime); 
                osc.start(); osc.stop(audioCtx.currentTime+0.3); 
            }
        }

        // --- 10 SORULUK SENARYO ---
        const scenario = [
            // GÃ–REV 1: TABLO OKUMA
            {
                id: 0,
                image: "https://images.unsplash.com/photo-1518182170546-0766aa6f7926?w=800",
                text: "[GÃ–REV 1/10] SÄ°BÄ°RYA<br>Dr. Paralel kaÃ§tÄ±. BÄ±raktÄ±ÄŸÄ± ÅŸifre 'Hissedilen SÄ±caklÄ±k'.<br>Veriler: <b>Hava -10Â°C, RÃ¼zgar 20 km/sa</b>.<br>Tabloyu kullanarak ÅŸifreyi gir.",
                clue: "Tabloda Ã¼stten -10'u, soldan 20'yi bul ve birleÅŸtir.",
                type: "input_table",
                correctAnswer: "-23", targetCorrect: 1, targetWrong: "wrong_0"
            },
            { id: "wrong_0", type: "dead_end", image: "https://images.unsplash.com/photo-1629814596134-2e2124707198?w=800", text: "HATALI VERÄ°!<br>Tabloyu dikkatli oku. -10 sÃ¼tunu ile 20 satÄ±rÄ±nÄ±n kesiÅŸimi.", choices: [{text:"TEKRAR DENE", target:0}] },

            // GÃ–REV 2: HARÄ°TA KIYASLAMA (ISINMA)
            {
                id: 1,
                image: "https://images.unsplash.com/photo-1451187580459-43490279c0fa?w=800",
                text: "[GÃ–REV 2/10] NASA UYDU MERKEZÄ°<br>Dr. Paralel 'En Ã‡ok IsÄ±nan' bÃ¶lgeye saklandÄ±. 1880 ve 2019 haritalarÄ±nÄ± kÄ±yasla. En koyu kÄ±rmÄ±zÄ± (en Ã§ok Ä±sÄ±nan) bÃ¶lge neresi?",
                clue: "Ekvator mu daha kÄ±rmÄ±zÄ±, yoksa Kutup noktasÄ± mÄ±?",
                type: "map_compare",
                choices: [
                    { text: "A) EKVATOR VE Ã‡Ã–LLER", target: "wrong_1", cost: 5 },
                    { text: "B) KUZEY KUTUP DAÄ°RESÄ°", target: 2, cost: 0 }
                ]
            },
            { id: "wrong_1", type: "dead_end", image: "https://images.unsplash.com/photo-1569336415962-a4bd9f69cd83?w=800", text: "YANLIÅ!<br>Haritaya bak. Kutuplardaki kÄ±rmÄ±zÄ±lÄ±k Ã§ok daha yoÄŸun.", choices: [{text:"GERÄ° DÃ–N", target:1}] },

            // GÃ–REV 3: Ä°NDÄ°RGENMÄ°Å SICAKLIK (YENÄ°)
            {
                id: 2,
                image: "https://images.unsplash.com/photo-1464822759023-fed622ff2c3b?w=800",
                text: "[GÃ–REV 3/10] AÄRI DAÄI (5137m)<br>Zirvedeki ajanÄ±mÄ±z donuyor! Zirvede hava <b>-20Â°C</b>. Deniz seviyesinde (0m) sÄ±caklÄ±k kaÃ§ derece olurdu?<br><i>(Kural: Her 200m'de sÄ±caklÄ±k 1Â°C artar.)</i>",
                clue: "Hesapla: 5000 metre fark var. 5000 / 200 = 25 derece fark eder. -20'ye 25 ekle.",
                type: "input_simple",
                correctAnswer: "5", targetCorrect: 3, targetWrong: "wrong_2"
            },
            { id: "wrong_2", type: "dead_end", image: "https://images.unsplash.com/photo-1483921020237-2ff51e8e4b22?w=800", text: "HESAP HATASI!<br>5000m aÅŸaÄŸÄ± inersen hava Ä±sÄ±nÄ±r. 25 derece Ä±sÄ±nmasÄ± lazÄ±m. -20 + 25 = ?", choices: [{text:"TEKRAR HESAPLA", target:2}] },

            // GÃ–REV 4: BÄ°TKÄ° GÃ–Ã‡Ãœ (DÄ°KEY)
            {
                id: 3,
                image: "https://images.unsplash.com/photo-1531366936337-7c912a4589a7?w=800",
                text: "[GÃ–REV 4/10] Ä°SVÄ°Ã‡RE ALPLERÄ°<br>KÃ¼resel Ä±sÄ±nma yÃ¼zÃ¼nden daÄŸdaki soÄŸuk seven Ã§iÃ§ekler yaÅŸam alanÄ± deÄŸiÅŸtiriyor. OnlarÄ± bulmak iÃ§in daÄŸÄ±n neresine bakmalÄ±sÄ±n?",
                clue: "Hava Ä±sÄ±nÄ±rsa serinlik nerede bulunur? Zirvede mi, etekte mi?",
                type: "choice",
                choices: [
                    { text: "A) AÅAÄI (ETEKLERE)", target: "wrong_3", cost: 5 },
                    { text: "B) YUKARI (ZÄ°RVEYE)", target: 4, cost: 0 }
                ]
            },
            { id: "wrong_3", type: "dead_end", image: "https://images.unsplash.com/photo-1502082553048-f009c37129b9?w=800", text: "YANLIÅ!<br>AÅŸaÄŸÄ±lar daha sÄ±caktÄ±r. Bitkiler serinlemek iÃ§in yukarÄ± kaÃ§ar.", choices: [{text:"GERÄ° DÃ–N", target:3}] },

            // GÃ–REV 5: OKYANUS AKINTILARI (YENÄ°)
            {
                id: 4,
                image: "https://images.unsplash.com/photo-1518837695005-2083093ee35b?w=800",
                text: "[GÃ–REV 5/10] ATLAS OKYANUSU<br>Gemimiz Ä°ngiltere'ye gidiyor. Bizi Ä±sÄ±tacak ve hÄ±zlandÄ±racak <b>SICAK</b> su akÄ±ntÄ±sÄ±nÄ± bulmalÄ±sÄ±n. AdÄ± ne?",
                clue: "Avrupa'nÄ±n batÄ±sÄ±nÄ± Ä±sÄ±tan meÅŸhur akÄ±ntÄ±.",
                type: "choice",
                choices: [
                    { text: "A) LABRADOR (SOÄUK)", target: "wrong_4", cost: 5 },
                    { text: "B) GULF STREAM (SICAK)", target: 5, cost: 0 },
                    { text: "C) KANARYA (SOÄUK)", target: "wrong_4", cost: 5 }
                ]
            },
            { id: "wrong_4", type: "dead_end", image: "https://images.unsplash.com/photo-1498335707130-ba50285e74eb?w=800", text: "YANLIÅ AKINTI!<br>SeÃ§tiÄŸin akÄ±ntÄ± soÄŸuktur, gemiyi yavaÅŸlatÄ±r. Bize sÄ±cak lazÄ±m.", choices: [{text:"GERÄ° DÃ–N", target:4}] },

            // GÃ–REV 6: NEM VE SICAKLIK (YENÄ°)
            {
                id: 5,
                image: "https://images.unsplash.com/photo-1504280501179-fac52dd2368f?w=800",
                text: "[GÃ–REV 6/10] Ã‡Ã–L VS ORMAN<br>Dr. Paralel bir ÅŸehrin nemini Ã§aldÄ±. Nemli hava yavaÅŸ Ä±sÄ±nÄ±p yavaÅŸ soÄŸur. AÅŸaÄŸÄ±daki hangi ÅŸehir <b>NEMLÄ°DÄ°R</b>?",
                clue: "Gece ile gÃ¼ndÃ¼z arasÄ±ndaki sÄ±caklÄ±k farkÄ± AZ olan nemlidir.",
                type: "choice",
                choices: [
                    { text: "A) GÃœNDÃœZ 40Â°C / GECE -5Â°C", target: "wrong_5", cost: 5 }, // Ã‡Ã¶l
                    { text: "B) GÃœNDÃœZ 25Â°C / GECE 20Â°C", target: 6, cost: 0 }  // Nemli
                ]
            },
            { id: "wrong_5", type: "dead_end", image: "https://images.unsplash.com/photo-1541893335552-3620f5c1564f?w=800", text: "DÄ°KKAT!<br>SeÃ§tiÄŸin ÅŸehirde fark Ã§ok fazla (45 derece). Bu Ã§Ã¶ldÃ¼r, nem yoktur. FarkÄ± az olanÄ± seÃ§.", choices: [{text:"GERÄ° DÃ–N", target:5}] },

            // GÃ–REV 7: Ä°ZOTERM HARÄ°TALARI (YENÄ°)
            {
                id: 6,
                image: "https://images.unsplash.com/photo-1524661135-423995f22d0b?w=800",
                text: "[GÃ–REV 7/10] HARÄ°TA ODASI<br>Dosyalar karÄ±ÅŸtÄ±. GÃ¼ney YarÄ±m KÃ¼re'de denizler Ã§ok olduÄŸu iÃ§in Ä°zoterm eÄŸrileri daha <b>DÃœZGÃœNDÃœR</b>. Hangi harita GÃ¼ney YarÄ±m KÃ¼re'ye aittir?",
                clue: "Ã‡izgilerin sapmadan dÃ¼mdÃ¼z gittiÄŸi haritayÄ± seÃ§.",
                type: "choice",
                choices: [
                    { text: "A) Ã‡OK KIVRIMLI Ã‡Ä°ZGÄ°LER", target: "wrong_6", cost: 5 },
                    { text: "B) DÃœZGÃœN GÄ°DEN Ã‡Ä°ZGÄ°LER", target: 7, cost: 0 }
                ]
            },
            { id: "wrong_6", type: "dead_end", image: "https://images.unsplash.com/photo-1582213782179-e0d53f98f2ec?w=800", text: "YANLIÅ DOSYA!<br>KÄ±vrÄ±mlÄ± Ã§izgiler Kuzey YarÄ±m KÃ¼re'dir (Kara Ã§ok olduÄŸu iÃ§in). GÃ¼neyde deniz Ã§oktur, Ã§izgiler dÃ¼zgÃ¼ndÃ¼r.", choices: [{text:"GERÄ° DÃ–N", target:6}] },

            // GÃ–REV 8: GÃœNEÅ AÃ‡ISI (YENÄ°)
            {
                id: 7,
                image: "https://images.unsplash.com/photo-1532978379173-523e16f371f2?w=800",
                text: "[GÃ–REV 8/10] GÃ–LGE BOYU<br>AjanÄ±n gÃ¶lgesinin en kÄ±sa olduÄŸu yere gitmesi lazÄ±m. 21 Mart'ta Ã¶ÄŸlen vakti GÃ¼neÅŸ nereye en dik aÃ§Ä±yla gelir (GÃ¶lge en kÄ±sa olur)?",
                clue: "GÃ¼neÅŸ Ä±ÅŸÄ±nlarÄ±nÄ±n dik dÃ¼ÅŸtÃ¼ÄŸÃ¼ yer Ekvator mudur, Kutuplar mÄ±?",
                type: "choice",
                choices: [
                    { text: "A) KUTUPLARA", target: "wrong_7", cost: 5 },
                    { text: "B) EKVATORA", target: 8, cost: 0 }
                ]
            },
            { id: "wrong_7", type: "dead_end", image: "https://images.unsplash.com/photo-1478131143081-80f7f84ca84d?w=800", text: "YANLIÅ!<br>Kutuplara gÃ¼neÅŸ eÄŸik gelir, gÃ¶lge Ã§ok uzun olur. Ekvatora dik gelir.", choices: [{text:"GERÄ° DÃ–N", target:7}] },

            // GÃ–REV 9: AFET SINIFLANDIRMA
            {
                id: 8,
                image: "https://images.unsplash.com/photo-1464822759023-fed622ff2c3b?w=800",
                text: "[GÃ–REV 9/10] ENDONEZYA<br>Haberlerdeki yalanÄ± bul. Hangi afet Ä°klim DeÄŸiÅŸikliÄŸi (Atmosfer) kÃ¶kenli DEÄÄ°LDÄ°R?",
                clue: "Yerin altÄ±ndan geleni bul.",
                type: "sort_game",
                targetCorrect: 9,
                items: [
                    { id: "i1", text: "Sel", type: "iklim" },
                    { id: "i2", text: "Volkan", type: "jeolojik" },
                    { id: "i3", text: "KuraklÄ±k", type: "iklim" },
                    { id: "i4", text: "Deprem", type: "jeolojik" }
                ],
                zones: [
                    { id: "iklim", label: "Ä°KLÄ°MSEL" },
                    { id: "jeolojik", label: "JEOLOJÄ°K (YER)" }
                ]
            },

            // GÃ–REV 10: HELÄ°KOPTER KAÃ‡IÅI (TABLO)
            {
                id: 9,
                image: "https://images.unsplash.com/photo-1521406606085-f37699317079?w=800",
                text: "[FÄ°NAL GÃ–REVÄ°] KAÃ‡IÅ ROTASI<br>Dr. Paralel'in motoru <b>-40Â°C</b> ve altÄ±nda donuyor. Tabloda hangi hava durumunda motor donar?",
                clue: "Tabloda karÅŸÄ±lÄ±ÄŸÄ± -40 veya daha kÃ¼Ã§Ã¼k (soÄŸuk) olanÄ± bul.",
                type: "choice_table",
                choices: [
                    { text: "A) HAVA -15 / RÃœZGAR 10", target: "wrong_8", cost: 5 }, 
                    { text: "B) HAVA -10 / RÃœZGAR 30", target: "wrong_8", cost: 5 }, 
                    { text: "C) HAVA -20 / RÃœZGAR 30", target: 99, cost: 0 }  
                ]
            },
            { id: "wrong_8", type: "dead_end", image: "https://images.unsplash.com/photo-1517480447814-68894451016c?w=800", text: "KAÃ‡TI!<br>SeÃ§tiÄŸin rotada motor donmadÄ±. Tabloda daha soÄŸuk bir deÄŸer bul.", choices: [{text:"TEKRAR DENE", target:9}] },

            // BÄ°TÄ°Å
            {
                id: 99,
                image: "https://images.unsplash.com/photo-1579546929518-9e396f3cc809?w=800",
                text: "GÃ–REV TAMAMLANDI!<br>DÃ¼nyayÄ± kurtardÄ±n Ajan. Ä°klim dengesi saÄŸlandÄ±.<br><br>AÅŸaÄŸÄ±daki KODU kopyala ve Ã¶ÄŸretmene gÃ¶nder.",
                isEnd: true,
                choices: []
            }
        ];

        function startGame() { 
            score = 100; 
            document.getElementById("status-text").innerText = "ONLÄ°NE";
            document.getElementById("status-text").style.color = "#0f0";
            if (audioCtx.state === 'suspended') audioCtx.resume();
            loadScene(0); 
        }

        function showPlaneAnimation(callback) {
            const plane = document.getElementById("plane-animation");
            plane.style.display = "flex";
            playSound('fly');
            setTimeout(() => {
                plane.style.display = "none";
                callback();
            }, 1200);
        }

        function loadScene(sceneId) {
            const scene = scenario.find(s => s.id === sceneId);
            const controls = document.getElementById("controls");
            const textDiv = document.getElementById("game-text");
            const contentDiv = document.getElementById("dynamic-content");
            const image = document.getElementById("scene-image");
            
            controls.innerHTML = "";
            contentDiv.innerHTML = "";
            document.getElementById("clue-box").innerText = scene.clue || "";
            image.src = scene.image;
            textDiv.innerHTML = scene.text;

            // Ä°Ã‡ERÄ°K
            if(scene.type === "input_table" || scene.type === "choice_table") renderTable(contentDiv);
            if(scene.type === "map_compare") {
                contentDiv.innerHTML = `
                    <div style="display:flex; gap:5px; overflow-x:auto;">
                        <div style="flex:1; text-align:center; color:#fff;">
                            <img src="https://svs.gsfc.nasa.gov/vis/a000000/a004700/a004787/1884_Region.jpg" style="width:100%; border:1px solid #555;"><br>1880 YILI
                        </div>
                        <div style="flex:1; text-align:center; color:#f55;">
                            <img src="https://svs.gsfc.nasa.gov/vis/a000000/a004700/a004787/2019_Region.jpg" style="width:100%; border:1px solid #f00;"><br>2019 YILI
                        </div>
                    </div>`;
            }

            // KONTROLLER
            if(scene.type === "input_table" || scene.type === "input_simple") {
                contentDiv.innerHTML += `<div class="input-group"><input type="text" id="ans" placeholder="CEVAP..."><button onclick="checkInput('${scene.correctAnswer}', ${scene.targetCorrect}, '${scene.targetWrong}')">GÃ–NDER</button></div>`;
            } 
            else if(scene.type === "sort_game") {
                renderDragGame(scene, contentDiv);
            }
            else if(scene.isEnd) {
                const code = `GEO-${Math.floor(Math.random()*9000)+1000}-${score}`;
                contentDiv.innerHTML = `<div style="border:2px dashed #0f0; padding:20px; text-align:center; font-size:24px; margin:20px 0;">${code}</div>`;
                controls.innerHTML = `<button onclick="window.open('${googleFormLink}', '_blank')">RAPORLA >></button><button onclick="startGame()">YENÄ°DEN OYNA</button>`;
            }
            else if(scene.choices) {
                scene.choices.forEach(c => {
                    const btn = document.createElement("button");
                    btn.innerText = c.text;
                    if(scene.type==="dead_end") btn.classList.add("btn-red");
                    btn.onclick = () => {
                        if(c.target.toString().startsWith("wrong") || scene.type==="dead_end") {
                            playSound('error'); if(c.cost) score-=c.cost; loadScene(c.target);
                        } else {
                            playSound('success'); if(c.cost) score-=c.cost;
                            showPlaneAnimation(() => loadScene(c.target));
                        }
                    };
                    controls.appendChild(btn);
                });
            }
        }

        function renderTable(container) {
            container.innerHTML = `
            <div class="table-wrapper">
                <table class="data-table">
                    <tr><th style="background:#444">RÃœZGAR \\ HAVA</th><th>5Â°C</th><th>0Â°C</th><th>-5Â°C</th><th>-10Â°C</th><th>-15Â°C</th><th>-20Â°C</th></tr>
                    <tr><th>Sakin</th><td>5</td><td>0</td><td>-5</td><td>-10</td><td>-15</td><td>-20</td></tr>
                    <tr><th>10 km/sa</th><td>2</td><td>-3</td><td>-9</td><td>-14</td><td>-20</td><td>-26</td></tr>
                    <tr><th>20 km/sa</th><td>-3</td><td>-10</td><td>-16</td><td>-23</td><td>-29</td><td>-35</td></tr>
                    <tr><th>30 km/sa</th><td>-6</td><td>-13</td><td>-20</td><td>-27</td><td>-34</td><td>-42</td></tr>
                    <tr><th>40 km/sa</th><td>-4</td><td>-15</td><td>-22</td><td>-29</td><td>-36</td><td>-43</td></tr>
                </table>
            </div>`;
        }

        function checkInput(correct, success, fail) {
            const val = document.getElementById("ans").value.trim();
            if(val === correct) { playSound('success'); showPlaneAnimation(() => loadScene(success)); }
            else { playSound('error'); score-=5; loadScene(fail); }
        }

        // --- SÃœRÃœKLE BIRAK ---
        function renderDragGame(scene, container) {
            const dragDiv = document.createElement("div");
            let poolHTML = ""; scene.items.forEach(i => poolHTML += `<div class="item" id="${i.id}" data-type="${i.type}" onclick="selectItem(this)">${i.text}</div>`);
            let zonesHTML = ""; scene.zones.forEach(z => zonesHTML += `<div class="zone" id="${z.id}" onclick="placeItem(this, ${scene.targetCorrect})"><h4>${z.label}</h4></div>`);
            dragDiv.innerHTML = `<div class="pool" id="pool">${poolHTML}</div><div class="zones">${zonesHTML}</div>`;
            container.appendChild(dragDiv);
        }

        function selectItem(el) {
            if(el.parentElement.classList.contains("zone")) return;
            document.querySelectorAll(".item").forEach(i => i.classList.remove("selected"));
            el.classList.add("selected");
            selectedItem = el;
            document.querySelectorAll(".zone").forEach(z => z.classList.add("active"));
        }

        function placeItem(zone, successTarget) {
            if(!selectedItem) return;
            zone.appendChild(selectedItem);
            selectedItem.classList.remove("selected");
            selectedItem = null;
            document.querySelectorAll(".zone").forEach(z => z.classList.remove("active"));
            
            if(document.getElementById("pool").children.length === 0) {
                let correct = true;
                document.querySelectorAll(".zone").forEach(z => {
                    Array.from(z.children).forEach(c => { if(c.classList.contains("item") && c.dataset.type !== z.id) correct = false; });
                });
                if(correct) { 
                    playSound('success'); 
                    document.getElementById("controls").innerHTML = `<button onclick="showPlaneAnimation(() => loadScene(${successTarget}))">ONAYLANDI: DEVAM ET >></button>`;
                } else {
                    playSound('error'); score-=10;
                    alert("HATA: Veriler yanlÄ±ÅŸ kutularda!");
                    const scene = scenario.find(s => s.type === "sort_game");
                    loadScene(scene.id);
                }
            }
        }
    </script>
</body>
</html>
